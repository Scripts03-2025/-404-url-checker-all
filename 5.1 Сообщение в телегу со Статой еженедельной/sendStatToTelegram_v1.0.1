// === üìä sendStatToTelegram_v1.0.1 ===
// –†–ê–ë–û–¢–ê–ï–¢ –ü–†–û–í–ï–†–ï–ù–û
// –í–µ—Ä—Å–∏–∏:
// v1.0.1 ‚Äî –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ "–ù–µ–¥–µ–ª—è", —Ç–µ–ø–µ—Ä—å —à–∏—Ä–∏–Ω–∞ —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏
// v1.0.0 ‚Äî –ü–µ—Ä–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è: –ø–æ–≤—ë—Ä–Ω—É—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏, –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π, —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω

function sendWeeklyStatsToTelegram() {
  const TELEGRAM_TOKEN = '8136586676:AAHvXeM4ih9ECPdSwzGM5P0O1p2_GYb_iTk';
  const TELEGRAM_CHAT_ID = '8003377702';

  const sheet = SpreadsheetApp.getActive().getSheetByName("s5 –°—Ç–∞—Ç–∞");
  const weeks = sheet.getRange(7, 3, 1, 5).getValues()[0];

  const params = {
    "–û–ø—É–±–ª": 10,
    "–ù–∞–ø–∏—Å": 11,
    "–í —Ä–∞–±": 12,
    "–Ø–Ω–¥–µ–∫—Å": 15,
    "–Ø+2–Ω–µ–¥": 16,
    "G+–º–µ—Å": 17
  };

  const dataByParam = {};
  for (const [label, row] of Object.entries(params)) {
    dataByParam[label] = sheet.getRange(row, 3, 1, 5).getValues()[0].map(v =>
      (v === '' || v === '–Ω–µ—Ç –∏–Ω—Ñ—ã') ? '–Ω/–¥' : v
    );
  }

  const fix = (val) => String(val).padStart(6, ' ');

  let msg = '–ù–µ–¥–µ–ª—è'.padEnd(16, ' ') + ' |' +
            ' –û–ø—É–±–ª |' +
            ' –ù–∞–ø–∏—Å |' +
            ' –í —Ä–∞–± |' +
            ' –Ø–Ω–¥–µ–∫—Å|' +
            ' –Ø+2–Ω–µ–¥|' +
            ' G+–º–µ—Å \n';

  for (let i = 0; i < 5; i++) {
    const week = (weeks[i] || '').padEnd(16, ' ');
    const row = [
      dataByParam["–û–ø—É–±–ª"][i],
      dataByParam["–ù–∞–ø–∏—Å"][i],
      dataByParam["–í —Ä–∞–±"][i],
      dataByParam["–Ø–Ω–¥–µ–∫—Å"][i],
      dataByParam["–Ø+2–Ω–µ–¥"][i],
      dataByParam["G+–º–µ—Å"][i]
    ].map(fix).join(' | ');
    msg += `${week} | ${row}\n`;
  }

  msg = `<pre>${msg}</pre>\nüìé <a href="https://docs.google.com/spreadsheets/d/1n3InvbH_nTghhPWpNUA6T0hSafVSlgW2XVmuL88EW1g/edit?gid=1655944420#gid=1655944420&range=A7">–û—Ç–∫—Ä—ã—Ç—å —Ç–∞–±–ª–∏—Ü—É</a>`;

  const payload = {
    chat_id: TELEGRAM_CHAT_ID,
    text: msg,
    parse_mode: "HTML"
  };

  const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
  UrlFetchApp.fetch(url, {
    method: "post",
    contentType: "application/json",
    payload: JSON.stringify(payload)
  });
}

/*
üìò –°–ø—Ä–∞–≤–∫–∞ –ø–æ sendStatToTelegram_v1.0.1

üîπ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
‚Äì –°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–∑ Google –¢–∞–±–ª–∏—Ü—ã "s5 –°—Ç–∞—Ç–∞"
‚Äì –ë–µ—Ä—ë—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ 6 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º: –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ, –ù–∞–ø–∏—Å–∞–Ω–æ, –í —Ä–∞–±–æ—Ç—É, –¢–æ–ø-10 –Ø–Ω–¥–µ–∫—Å–∞, –Ø+2 –Ω–µ–¥–µ–ª–∏, Google + –º–µ—Å—è—Ü
‚Äì –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –Ω–µ–¥–µ–ª—å (—Å—Ç–æ–ª–±—Ü—ã C:G)
‚Äì –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≤–∏–¥–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
‚Äì –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram (–ø–æ —Ç–æ–∫–µ–Ω—É –∏ chat_id)
‚Äì –í—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –Ω—É–∂–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ

üîπ –ì–¥–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:
‚Äì –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Å—Ç—Ä–æ–∫–∏ ‚Äî —Å–º–æ—Ç—Ä–∏ –æ–±—ä–µ–∫—Ç `params`
‚Äì –ö–æ–ª–æ–Ω–∫–∏ (5 –Ω–µ–¥–µ–ª—å) ‚Äî –±–µ—Ä—É—Ç—Å—è –∏–∑ —Å—Ç—Ä–æ–∫–∏ 7, —Å—Ç–æ–ª–±—Ü—ã C:G
‚Äì –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–∞–±–ª–∏—Ü—É ‚Äî –≤–Ω–∏–∑—É —Å–∫—Ä–∏–ø—Ç–∞, –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å
‚Äì –¢–æ–∫–µ–Ω –∏ chat_id ‚Äî –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏

üîπ –í–∞–∂–Ω–æ:
‚Äì –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `parse_mode: HTML` –∏ —Ç–µ–≥ `<pre>` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚Äì –°—Ç—Ä–æ–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∏—Ä–∏–Ω—ã ‚Äî –≤—Å—ë —Ä–æ–≤–Ω–æ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
‚Äì –ó–Ω–∞—á–µ–Ω–∏—è '–Ω–µ—Ç –∏–Ω—Ñ—ã' –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ '–Ω/–¥' –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è

üîπ –í–µ—Ç–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
https://chatgpt.com/c/67e983c4-1050-8010-ad78-082a36dc7fc6

üîπ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è:
‚Äì –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚Äì –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
‚Äì –¶–≤–µ—Ç–æ–≤–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞
‚Äì –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–∏–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3 –∏–ª–∏ 8 –Ω–µ–¥–µ–ª—å)
*/
